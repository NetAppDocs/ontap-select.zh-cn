---
sidebar: sidebar 
permalink: concept_cluster_expansion.html 
keywords: cluster, expand, expansion, single, two, node deployment workflow, workflow, deployment steps 
summary: '通过将现有单节点集群配置为高可用性(HA)对、将这两个节点扩展为双节点集群。' 
---
= 展开集群
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
从ONTAP 9.13.1开始、您可以通过将现有单节点集群配置为高可用性(HA)对来将这两个节点扩展为双节点集群。扩展为双节点HA集群可提供高可用性、从而防止节点中断对集群提供数据的能力产生影响。

操作步骤会自动执行、并可通过ONTAP Select Deploy使用命令行界面或Web界面启动。这是一个有中断的操作步骤。

.集群扩展前提条件
在启动集群扩展操作步骤之前、请确认满足以下前提条件：

* 已打开现有节点的电源。
* 您已成功对现有节点执行集群刷新。
* 现有节点和新节点的ESX主机具有相同的配置。
* 您已成功在现有节点和新节点的ESX主机之间运行网络连接检查程序。
* 要使用ONTAP Select Deploy集群扩展操作步骤、您必须具有评估版许可证(90天)和生产(容量层或容量池)许可证。验证您是否满足以下许可要求：
+
--
** 您已获得新节点所需的容量层或容量池许可证。
+

NOTE: 对于容量池许可证、您可以使用现有池中的未使用容量。如果需要、您可以通过升级许可证来增加容量。

** 如果两个节点都具有容量池许可证、则它们属于同一个容量池。
** 您已对两个节点应用相同的许可证类型。


--
+
双节点集群中每个节点(现有节点和新节点)的许可证要求是单节点集群要求的两倍：

+
--
** 对于单节点集群、完整许可证可用于数据聚合。例如、具有1 TB许可证的单节点可以托管1 TB的数据聚合。
** 对于双节点集群、一半的许可证容量用于每个节点上的数据聚合、另一半容量用于对应配对节点的数据聚合的镜像磁盘。例如、具有2 TB许可证的两个节点会托管1 TB的数据聚合、每个节点会为数据聚合提供2 TB的总可用容量、而2 TB则用于托管聚合的镜像磁盘。


--
+
有关许可证的详细信息、请参见 link:concept_lic_evaluation.html["许可证"] 部分。

* 连接到节点的数据存储库符合以下标准：
+
** 现有节点上的数据存储库类型必须相同、例如VMware虚拟机文件系统(Virtual Machine File System、VMFS)-5、VMFS-6或NFS。
** 连接到新节点的数据存储库的类型必须与现有节点的默认数据存储库相同。
** 现有节点上的数据存储库的可用空间必须等于或大于此节点上的已用空间。
** 连接到新节点的数据存储库上的可用空间必须是现有节点上总已用空间的两倍。


* 两个ONTAP Select节点的实例类型相同。


.硬件和软件要求
新节点和现有节点必须满足多项硬件和软件要求：

* 现有单节点集群正在运行ONTAP 9.13.1.或更高版本。
* 现有节点和新节点的ESX主机满足以下条件：
+
** 它们支持vCenter Server 7.0 Update 3或更高版本。NetApp还建议使用vCenter Server 7.0或更高版本。
** 它们具有用于集群间连接的内部网络。


* 现有节点和新节点均为硬件RAID类型。
* 对于小型实例类型、此节点至少具有16 GB RAM和四个CPU。对于大型实例类型、此节点最多具有128 GB RAM和16个CPU。


.集群扩展限制
对于ONTAP Select集群扩展、应注意以下限制：

* 操作步骤仅支持将单节点集群扩展为双节点集群。
* 扩展限制为64 TB数据存储库总容量；数据存储容量为32 TB、其余32 TB为用于数据镜像的额外空间。
* 只有硬件RAID节点和集群类型才支持集群扩展。不支持扩展到软件和硬件混合RAID类型。


下图显示了扩展前的单节点配置和扩展后的双节点HA对配置。
image:cluster_expansion_two_node.PNG["单节点到双节点集群扩展图"]

.启动集群扩展操作步骤
要启动ONTAP Select Deploy以运行集群扩展操作步骤、请从命令行界面运行以下命令：

. `node add -cluster-name <cluster_name> -nodes <2nd_node_name>`
. `node modify -cluster-name <cluster_name> -name <1st_node_name> -internal-networks ONTAP-Internal`
. `node modify -cluster-name <cluster_name> -name <2nd_node_name> -mgmt-ip <node_ip> -host-name <host_name> -management-networks ONTAP-Management -internal-networks ONTAP-Internal -data-networks ONTAP-External -passthrough-disks false`
. `node storage pool attach -cluster-name <cluster_name> -node-name <2nd_node_name> -name <storage_pool_name> -capacity-limit <capacity>`
. `cluster expand -name <cluster_name>`
+
出现提示时、输入您的ONTAP管理员密码。


